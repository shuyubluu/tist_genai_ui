<h1 class="inner-title">1-7 個案結案表</h1>
<div class="mt"></div>
<div class="table-container">
  <ng-container>
    <form [formGroup]="form">
      <nz-table class="bordered-table">
        <tr>
          <th class="custom-header" colSpan="4" nzAlign="center">訪視概況</th>
        </tr>
        <tr>
          <th class="th-cell custom-header bold-text" nzAlign="center">
            填表日期
          </th>
          <td class="td-cell custom-cell">
            <app-dayPicker formControlName="formFillingDate" />
          </td>
          <th class="th-cell custom-header bold-text" nzAlign="center">
            結案日期
          </th>
          <td class="td-cell custom-cell">
            <app-dayPicker formControlName="closureDate" />
            <app-error-message
              [control]="form.get('closureDate')"
              [isTouched]="false"
              errorKey="required"
              errorMessage="這是必選的選項。"
            />
          </td>
        </tr>
        <tr>
          <th
            colspan="1"
            class="th-cell custom-header bold-text"
            nzAlign="center"
          >
            結案原因
          </th>
          <td colspan="3" class="td-cell custom-cell">
            <app-select
              [selectWidth]="'175px'"
              [defaultPlaceHolder]="false"
              [options]="selectOptions_closureReason"
              (ngModelChange)="handleClosureReasonChange($event)"
              formControlName="closureReason"
            />
            <app-input
              [inputWidth]="'175px'"
              [maxLength]="30"
              formControlName="closureReason_other"
            />
            <app-error-message
              [control]="form.get('closureReason')"
              [isTouched]="false"
              errorKey="required"
              errorMessage="這是必選的選項。"
            />
            <app-error-message
              [control]="form.get('closureReason_other')"
              [isTouched]="false"
              errorKey="required"
              errorMessage="這是必填欄位。"
            />
          </td>
        </tr>
        <tr>
          <th
            colspan="1"
            class="th-cell custom-header bold-text"
            nzAlign="center"
          >
            重要事項概要
          </th>
          <td colspan="3" class="td-cell custom-cell">
            <nz-textarea-count [nzMaxCharacterCount]="500" data-count="0/500">
              <textarea
                rows="4"
                nz-input
                [maxlength]="500"
                formControlName="importantSummary"
              ></textarea>
            </nz-textarea-count>
            <app-error-message
              [control]="form.get('importantSummary')"
              [isTouched]="false"
              errorKey="required"
              errorMessage="這是必填欄位。"
            />
          </td>
        </tr>
        <tr>
          <th class="custom-header" colSpan="4" nzAlign="center">主管簽核</th>
        </tr>
        <tr>
          <th
            colSpan="1"
            class="th-cell custom-header bold-text"
            nzAlign="center"
          >
            單位主管意見
          </th>
          <!-- !TODO -->
          <td colSpan="3" class="td-cell custom-cell">
            <app-button [buttonIcon]="'accept'" [buttonText]="'同意'" />
            <app-button [buttonIcon]="'close'" [buttonText]="'退回'" />
            <nz-textarea-count [nzMaxCharacterCount]="500" data-count="0/500">
              <textarea
                rows="4"
                nz-input
                [maxlength]="500"
                formControlName="supervisorOpinion"
              ></textarea>
            </nz-textarea-count>
            <app-error-message
              [control]="form.get('supervisorOpinion')"
              [isTouched]="false"
              errorKey="required"
              errorMessage="這是必填欄位。"
            />
          </td>
        </tr>
        <tr>
          <th colspan="4" class="custom-header">
            <app-button
              [buttonIcon]="'save'"
              [buttonText]="'草稿儲存'"
              (click)="save()"
            />
            <app-button
              [buttonIcon]="'accept'"
              [buttonText]="'送審'"
              (click)="review()"
            />
            <app-button
              [buttonIcon]="'close'"
              [buttonText]="'關閉'"
              (click)="closeTab('個案結案表')"
            />
          </th>
        </tr>
      </nz-table>
    </form>
  </ng-container>
</div>
